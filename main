var map = ui.Map();
var map_style = require("users/dawnschumacher/nasa-eej:style/map-style").style;

var legend = ui.Panel();
var legend_style = require("users/dawnschumacher/nasa-eej:style/legend-style");

// init function, run on first load.
function init_application() {
  
  // Sets the map's visual style, creating a grayscale map.
  map.setOptions('Map', {
    Map: map_style
  },
  ["Map","SATELLITE"]);
  
  // Modifies the map controls, disabling unnessecary ones to improve readability.
  map.setControlVisibility({
      all: false,
      layerList: true,
      zoomControl: true,
      scaleControl: true,
      mapTypeControl: true,
      fullscreenControl: false
  });
  
  // Sets the cursor style to a crosshair.
  map.style().set('cursor', 'crosshair');
  
  // Centers the map on the San Francisco bay.
  map.setCenter(-122.355537, 37.828, 9);
  
  // Replaces the base map with a cleaner, custom map.
  ui.root.clear();
  
  var spacer = ui.SplitPanel(
    map, legend.object
  ) 
  
  ui.root.add(spacer);
}

/*
  UI
*/

// Create the base content panel inside the legend.
var content = ui.Panel({
  style: legend_style.panel
});

// Create the base navbar panel.
var navbar = ui.Panel({
  layout: ui.Panel.Layout.flow('vertical'),
  style: legend_style.navbar
});
  
// Create the containing panel for the row of buttons at the top, ensuring they are
// displayed in a horizontal row.
var button_row = ui.Panel({
  layout: ui.Panel.Layout.flow('horizontal'),
})
  
// Create the blue highlight bar that changes position.
var nav_highlight = ui.Panel({
  style: legend_style.nav_highlight
})
  
// Create the buttons. I would do this with a loop but it literally didn't work whatsoever.
var about_button = ui.Button({
  label: "About",
  style: legend_style.navbar_button
})

var explore_button = ui.Button({
  label: "Explore",
  style: legend_style.navbar_button
});

var layer_select_button = ui.Button({
  label: "Layer Select",
  style: legend_style.navbar_button
});

// Add the navbar buttons to the navigation panel.
button_row.add(about_button);
button_row.add(explore_button);
button_row.add(layer_select_button);

// Construct the final navbar object.
navbar.add(button_row);
navbar.add(nav_highlight);

// Changes the visible section by stretching or shrinking the margin of the blue highlight UI panel.
function change_highlight(section_index) {
  print(section_index);
  
  nav_highlight.style().set({
    margin: "0% 0% 0% " + (33.3 * section_index).toString() + "%"
  });
}

init_application()